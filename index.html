<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport"
 content="width=device-width,
initial-scale=1, viewport-fit=cover">
<meta name="theme-color" content="#000000">
<title>FOR YOU‚ù§Ô∏è</title>
<link rel="preload" href="https://fonts.gstatic.com" as="font" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=block" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
<style>
html,body{
  margin:0;
  padding:0;
  height:100%;
  overflow:hidden;
  background:black;
touch-action:none;
}
canvas{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  display:block;
 will-change: transform;

}
#start{
  position: fixed;
  inset: 0;
  background: black;
  display: flex;
  align-items: center;
  justify-content: center;
  color: pink;
  font-size: 22px;
  z-index: 10;
  cursor: pointer;
}
</style>
</head>

<body>

<div id="start">üíó Ch·∫°m v√†o m√†n h√¨nh ƒë·ªÉ b·∫Øt ƒë·∫ßu üíó</div>
<canvas id="canvas"></canvas>

<audio id="music" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let w, h;
const startScreen = document.getElementById("start");
const music = document.getElementById("music");
let stars = [];

function resizeCanvas(){
  const dpr = window.devicePixelRatio || 1;

  w = window.innerWidth;
  h = window.innerHeight;

  canvas.width = w * dpr;
  canvas.height = h * dpr;
  canvas.style.width = w + "px";
  canvas.style.height = h + "px";

  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
}
resizeCanvas();
createStars();

window.addEventListener("resize", ()=>{
  resizeCanvas();
  createStars(); // ‚≠ê t·∫°o l·∫°i khi xoay m√†n
});
let showFalling = false;
let showText = true;
let showHeart = false;
let time = 0;
const HEART_TIME = 41.8;      // gi√¢y tim xu·∫•t hi·ªán
const FALL_TIME = 67.5;
const FADE_DURATION = 5; // m·ªù 3 gi√¢y
let colorTime = 0;
let pulse = 1;
let dkAlpha = 1;
// =====FALLING WORDS====
function shuffle(arr){
  for(let i = arr.length-1; i > 0; i--){
    let j = Math.floor(Math.random()*(i+1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}
const fallWords = [

"Love you","C·∫£m ∆°n anh","PND‚ù§Ô∏èQGK",
"Bae","Em y√™u anh",
"Only you","‚ù§Ô∏è",
"Y√™u anh","‚ù§Ô∏è","Th∆∞∆°ng anh ‚ù§Ô∏è",
"Choose you","My heart belongs to you","My love remains with you",
"Still you","M√£i ·ªü b√™n anh ‚ù§Ô∏è",
"Just us","C·∫£m ∆°n anh v√¨ ƒë√£ ƒë·∫øn",
"I love you", "14/02/2026",
"Miss you","‚ù§Ô∏è","L√† thi√™n v·ªã, l√† ∆∞u ti√™n, l√† duy nh·∫•t",
"No regrets",
"My heart","Anh b·∫£o v·ªá t·ªï qu·ªëc ‚ù§Ô∏è em b·∫£o v·ªá anh",
"Be mine ‚ù§Ô∏è","Under the same sky ‚ù§Ô∏è",
"Together","‚ù§Ô∏è","Em v·∫´n ·ªü ƒë√¢y","Ch·ªù anh v·ªÅ","Em nh·ªõ anh ‚ù§Ô∏è",
"Only us","Stay with me",
"Forever ‚ù§Ô∏è"];
// ==========================
// üå∏ SMART FALLING TEXT SYSTEM ‚Äì FINAL
// ==========================

let fallingTexts = [];
let wordIndex = 0;

let groupIndex = 0;
let columnIndex = 0;
let spawnTimer = 0;

const columns = 8;
const spawnGap = 22; // ‚≠ê m∆∞a d√†y h∆°n (gi·∫£m = nhi·ªÅu h∆°n)

let gapX;


// ‚≠ê layout tim
const groups = [
  [3,4],
  [2,5],
  [1,6],
  [0,7]
];


// ==========================
// CREATE
// ==========================
function createFalling(){

  fallingTexts = [];
  shuffle(fallWords);
  wordIndex = 0;

  gapX = w / columns;

  ctx.textAlign = "center";
  ctx.textBaseline = "middle";

  // ‚≠ê tƒÉng pool ‚Üí kh√¥ng b·ªã tr·ªëng
  for(let i=0;i<120;i++){

    fallingTexts.push({
      text: "",
      column: 0,

      x: 0,
      y: -9999,

      speed: 0,
      size: 0,

      baseAlpha: 1,
      alpha: 1,

      active: false
    });
  }
}


// ==========================
// SPAWN 1 TEXT
// ==========================
function spawnOne(col){

  for(let f of fallingTexts){

    if(!f.active){

      f.active = true;

      f.text = fallWords[wordIndex++ % fallWords.length];

      // ‚≠ê random size nh·∫π
      f.size = 20 + Math.random()*8;

      ctx.font = "600 " + f.size + "px 'Playfair Display', serif";

      let textWidth = ctx.measureText(f.text).width;

      // ‚≠ê padding theo ƒë·ªô d√†i ‚Üí KH√îNG BAO GI·ªú c·∫Øt ch·ªØ
      let padding = textWidth/2 + 18;

      let left  = col * gapX + padding;
      let right = (col+1) * gapX - padding;

      // n·∫øu c√¢u qu√° d√†i th√¨ √©p v√†o gi·ªØa c·ªôt
      if(right <= left){
        f.x = col * gapX + gapX/2;
      }else{
        f.x = left + Math.random() * (right-left);
      }

      f.y = -100 - Math.random()*150;

      f.speed = 0.45 + Math.random()*0.25;

      f.baseAlpha = 0.7 + Math.random()*0.3;
      f.alpha = f.baseAlpha;

      f.column = col;

      break;
    }
  }
}



// ==========================
// DRAW
// ==========================
function drawFalling(dt){

  spawnTimer += dt;


  // ‚≠ê spawn li√™n t·ª•c t·ª´ng c·ªôt (kh√¥ng ƒë·ªôt ng·ªôt)
  if(spawnTimer > spawnGap){

    spawnTimer = 0;

    let currentGroup = groups[groupIndex];
    let col = currentGroup[columnIndex];

    spawnOne(col);

    columnIndex++;

    if(columnIndex >= currentGroup.length){
      columnIndex = 0;
      groupIndex = (groupIndex + 1) % groups.length;
    }
  }



  // ======================
  // DRAW ALL
  // ======================
  for(let f of fallingTexts){

    if(!f.active) continue;

    ctx.globalAlpha = f.alpha;

    ctx.fillStyle = "#ffd6f3";
    ctx.font = "600 " + f.size + "px 'Playfair Display', serif";

    ctx.fillText(f.text, f.x, f.y);


    // ‚≠ê r∆°i theo dt ‚Üí m∆∞·ª£t m·ªçi FPS
    f.y += f.speed * dt;



    // ‚≠ê fade cu·ªëi m√†n
    let fadeStart = h * 0.82;

    if(f.y > fadeStart){
      let p = (f.y - fadeStart)/(h - fadeStart);
      f.alpha = f.baseAlpha * (1-p);
    }else{
      f.alpha = f.baseAlpha;
    }
// ‚≠ê reset
    if(f.y > h + 50){
      f.active = false;
    }
  }

  ctx.globalAlpha = 1;
}
function createStars(){

  stars = [];

  let count = Math.floor((w * h) / 9000); 
  // ‚≠ê s·ªë c√†ng nh·ªè ‚Üí c√†ng nhi·ªÅu sao
  // 9000 = v·ª´a ƒë·∫πp mobile
  // 7000 = d√†y h∆°n
  // 5000 = r·∫•t d√†y (lung linh)

  for(let i=0;i<count;i++){
    stars.push({
      x: Math.random()*w,
      y: Math.random()*h,
      r: Math.random()*1.8+0.4,
      v: Math.random()*0.6+0.2,
      phase: Math.random()*Math.PI*2,
      speed: 0.02 + Math.random()*0.03
    });
  }
}
// ===== TEXT =====
const messages = [
  "M·ªôt b·∫ßu tr·ªùi ƒë·∫ßy sao l·∫•p l√°nh...",
"ƒê√¢y l√† m√≥n qu√† nh·ªè",
"Em mu·ªën d√†nh ri√™ng cho anh",
"Gi·ªØa ng√¢n h√† v√¥ t·∫≠n ·∫•y",
"Ch·ªâ c√≥ tr√°i tim em v√¨ anh m√† t·ªèa s√°ng",
"L·∫ßn n√†y, em ƒë√£ c√≥ th·ªÉ ng·∫Øm sao c√πng anh r·ªìi",
"Nh·ªØng v√¨ sao do ch√≠nh tay em t·∫°o ra",
"Mang theo t·∫•t c·∫£ y√™u th∆∞∆°ng em mu·ªën g·ª≠i ƒë·∫øn anh",
"Trong kho·∫£nh kh·∫Øc n√†y,",
"Ch·ªâ c√≥ tr√°i tim v√† b·∫ßu tr·ªùi ·∫•y",
"Kho·∫£ng c√°ch d∆∞·ªùng nh∆∞ tan bi·∫øn",
"V√† ch√∫ng ta m√£i ·ªü b√™n nhau",
"No matter the distance between us,",
"My heart will always find you under the same sky. ‚ù§Ô∏è"
  ];
let textIndex = 0;
let textAlpha = 0;


// ===== HEART =====
let particles = [];
function heart(t){
  return {
    x: 16 * Math.pow(Math.sin(t),3),
    y: 13*Math.cos(t)
      -5*Math.cos(2*t)
      -2*Math.cos(3*t)
      -Math.cos(4*t)
  };
}

function createHeart(){
  particles = [];
  for(let t=0;t<Math.PI*2;t+=0.06){
    let p = heart(t);
if (Math.abs(p.x) < 6 && Math.abs(p.y) < 6) continue;


for(let i=0;i<8;i++){
let spread = Math.random()*3;
      particles.push({
        baseX: p.x + (Math.random()-0.5)*spread,
        baseY: p.y + (Math.random()-0.5)*spread,
        offset: Math.random()*Math.PI*2,
        rise: Math.random()*h,
        alpha: Math.random()*0.4 + 0.5,
        size: Math.random()*6 + 3
      });
    }
  }

}

// ===== DRAW =====
let lastTime = 0;
function draw(now){
let dt = (now - lastTime) / 16.6;
lastTime = now;
let t = (performance.now() - startTime) / 1000;
if (!dt || dt > 3) dt = 1;
    // n·ªÅn
  ctx.fillStyle="black";
  ctx.fillRect(0,0,w,h);

  // sao
  // sao
for(let s of stars){

  s.y += s.v * dt;
  if(s.y > h) s.y = 0;

  s.phase += s.speed;

  let twinkle = Math.sin(s.phase) * 0.7 + 0.7;
       // ‚≠ê th√™m glow NGAY TR∆Ø·ªöC khi fill
    ctx.fillStyle = `rgba(255,255,255,${twinkle})`;
  ctx.beginPath();
  ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
  ctx.fill();
}

ctx.shadowBlur = 0; // ‚≠ê reset SAU v√≤ng l·∫∑p (r·∫•t quan tr·ªçng)
  

  // ===== TEXT INTRO =====
  // ===== TEXT INTRO (SYNC THEO NH·∫†C) =====
if(showText){
  const totalDuration = HEART_TIME; // th∆∞ ch·∫°y t·ªõi 41s
  const perLine = totalDuration / messages.length;

  textIndex = Math.floor(t / perLine);

  if(textIndex >= messages.length){
    textIndex = messages.length - 1;
  }

  let local = (t % perLine) / perLine;
  textAlpha = Math.sin(local * Math.PI);

  ctx.fillStyle = `rgba(255,210,220,${textAlpha})`;
  ctx.font = "25px 'Playfair Display'";
  ctx.textAlign = "center";

  ctx.shadowBlur = 8;
  ctx.shadowColor = "#ffb6e6";

  ctx.fillText(messages[textIndex], w/2, h/2);

  ctx.shadowBlur = 0;
}

  // ===== HEART =====
  if(showHeart){
const heartStart = HEART_TIME;   // 41
const heartEnd = FALL_TIME;      // 82

let fadeStart = heartEnd - FADE_DURATION;

if(t < fadeStart){
  dkAlpha = 1; // hi·ªán full
}else{
  dkAlpha = 1 - (t - fadeStart) / FADE_DURATION;
}

dkAlpha = Math.max(0, Math.min(1, dkAlpha));
time += 0.04 * dt;
        colorTime += 0.02 * dt;

    pulse = 1 + Math.sin(time)*0.07;

    let cx = w/2;
    let cy = h/2;
ctx.shadowBlur = 4;
ctx.shadowColor = "rgba(255,120,180,0.9)";
    for(let p of particles){
      p.offset += 0.06 * dt;
      if(p.rise > 0) p.rise -= 0.5 * dt;

      let x = cx + p.baseX*7*pulse + Math.cos(p.offset)*1.2;
      let y = cy - p.baseY*7*pulse + Math.sin(p.offset)*1.2 + p.rise;

      let r = 255 + Math.sin(colorTime)*35;
let g = 130 + Math.sin(colorTime+2)*40;
      let b = 180 + Math.sin(colorTime+4)*40;

let fade = Math.abs(p.baseY) - 8;
fade = Math.max(0, Math.min(fade / 10, 1));

// tƒÉng s√°ng ph·∫ßn gi·ªØa
let brightnessBoost = 0.9;

let finalAlpha = Math.min( p.alpha * brightnessBoost * (1 - fade * 0.6),1);

ctx.fillStyle = `rgba(${r},${g},${b},${finalAlpha})`;
      ctx.beginPath();
      ctx.arc(x,y,p.size*0.4,0,Math.PI*2);
      ctx.fill();
    }

    // ===== CENTER TEXT (T·ª∞ BI·∫æN M·∫§T) =====
if (dkAlpha > 0) {
  ctx.globalAlpha = dkAlpha;

ctx.save();
ctx.translate(cx, cy);
ctx.scale(pulse, pulse);

ctx.font = "18px 'Great Vibes',cursive";
ctx.textAlign = "center";
ctx.textBaseline = "middle";
ctx.fillStyle = "rgba(255,200,220,1)";
ctx.fillText("Happy Valentine's Day", 0, 0);

ctx.restore();

ctx.globalAlpha = 1;
 }
if(dkAlpha <= 0 && !showFalling){   // ‚≠ê khi text bi·∫øn m·∫•t
    showFalling = true;
    createFalling();
  }
}

// ‚≠ê v·∫Ω ch·ªØ r∆°i
if(showFalling){
  drawFalling(dt);
}
// ===== SYNC THEO TIME TH·ª∞C (KH√îNG D√ôNG NH·∫†C) =====
if(t >= HEART_TIME && !showHeart){
  showText = false;
  showHeart = true;
  createHeart();
}

if(t >= FALL_TIME && !showFalling){
  showFalling = true;
  createFalling();
}
requestAnimationFrame(draw);
}
// ===== START =====
startScreen.addEventListener("click", async ()=> {
startTime = performance.now(); // ‚≠ê reset th·ªùi gian khi b·∫Øt ƒë·∫ßu
  startScreen.style.display = "none";

  if(document.documentElement.requestFullscreen){
    document.documentElement.requestFullscreen();
  }

  music.play();
  // ‚≠ê ƒê·ª¢I FONT LOAD XONG HO√ÄN TO√ÄN
  await document.fonts.load("18px Great Vibes");
await document.fonts.load("25px Playfair Display");
  // ‚≠ê √©p browser cache font tr∆∞·ªõc 1 l·∫ßn
  ctx.font = "20px 'Great Vibes'";
ctx.fillText(" ", 0, 0);

ctx.font = "25px 'Playfair Display'";
ctx.fillText(" ", 0, 0);
 requestAnimationFrame(draw);});
</script>

</body>
</html>